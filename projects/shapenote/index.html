<!DOCTYPE html>
<html>

<head>
    <!--<link rel="stylesheet" type="text/css" href="css/main.css"> -->
    <link href="https://fonts.googleapis.com/css?family=Cinzel|Dosis|Inconsolata|Rambla|Volkhov" rel="stylesheet">
    <title>
        Topher Lawton | Shape-Note Projects
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
</head>

<body>
    <header>
        <img src="../../../MiniSheep.png" alt="HieAnon Sheep Logo">
        <nav>
            <ul>
                <li><a href="../../index.html">home</a></li>
                <li><a href="../../about.html">about</a></li>
                <li><a href="../../portfolio.html">portfolio</a></li>
                <li><a href="../../contact.html">contact</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <section class="main-content">
            <h1>Sacred Harp Index Subsets</h1>
            <p>This is a very early version of a tool to print out a "cheat sheet" index of sacred harp tunes, formatted to tuck into a shape-note tunebook.
                <br /> Here's how it works:
                <br /> Select one of your desired songs from the dropdown, and hit "Add song to list"--You'll build a list of songs in no time!
                <br /> When your list is complete, hit "Get Details" and it will fetch info about each song in the list. (Currently limited to page number and title.)
                <br /> Details for your chosen songs will appear below</p>
            <br />
            <br />
            <br />

            <select name="select" id="SongChooser"> <!-- TODO Multiple selection: need to slice selects so they're separate elements -->

</select>

            <button onclick="listSongs()">Add song to list</button>


            <div class="songList-container">
                <ul id="chosenSongs">

                </ul>
            </div>
            <br />
            <button id="details">Get Details</button>

            <br />
            <div>
                <ul class="songDetails-container">
                </ul>
            </div>

            <br />
            <br />
            <p>If you need a reminder of all song numbers/titles, click here:</p>
            <button id="fetch">Fetch All Songs</button>
            <div class="allSong-container">
            </div>


        </section>

    </main>
    <footer>
        <p class="site-info">
            Version 0 | Site initially created 24 July 2016 | <a href="https://github.com/HieAnon/hieanon.github.io">Code on Github</a></p>
    </footer>

    <!--

SCRIPTS BELOW THIS BREAK

-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js">
        //JQuery!
    </script>

    <script>

      ;(function($){
        var loadData = function (runThisFunctionNow){
          $.ajax({
            url: 'SacredHarpTitleData.json',
            dataType: 'json',
            success: runThisFunctionNow
          });
        };

        var fillDropdown = function(response){
            var listOptions = "";
            for (var i = 0; i < response.length; i++) {
                listOptions += '<option value="' + response[i].pageID.toString() + '">' + response[i].pageID.toString() + '</option>';
            }
            $('#SongChooser').html(listOptions);
        };

        var listDetails = function(response,array) {
            var songDetails = "";
            for (var i = 0; i < response.length; i++) {
                if (songID == response[i].pageID.toString()) {
                    songDetails += '<li>' + response[i].pageID.toString() + ": " + response[i].songTitle.toString() + '</li>';
                    $('.songDetails-container').append(songDetails);
                }
            }
        };

        var showAllSongs = function(response) {
              var html = "";
              for (var i = 0; i < response.length; i++) {
                  html += '<div class="data-bit">' + response[i].pageID.toString() + ": " + response[i].songTitle.toString() + '</div>';
              }
              $('.allSong-container').html(html)
        };

        var clickEvents = function () {
          $('#details').on('click',function(event){
            var array = [];
            $(".chosenSong").each(function(index, element) { //go find each element with class chosenSong
                array.push($(this).text());//run the getSongDetails function on it.
                console.log("Fetching details for " + $(this).text()); //
            });

              loadData(listDetails(array));
          });

          $('#fetch').on('click',function(){
            loadData(showAllSongs);
          });
        };

        var init = function() {
          loadData(fillDropdown);
          clickEvents();
        };

        init();
      })(jQuery);



    </script>

    <script>
        //Add songs from dropdown to list
        function listSongs() {
            var chosenSong = $('#SongChooser').val();
            var songlist = $('#chosenSongs');
            songlist.append("<li class='chosenSong'>" + chosenSong + "</li>");
        };
    </script>

    <script>
        //this is the script that looks through the chosen list and gets the details.
        function getSongListData() {
            $(".chosenSong").each(function(index, element) { //go find each element with class chosenSong
                getSongDetails($(this).text());//run the getSongDetails function on it.
                console.log("Fetching details for " + $(this).text()); //
            });
        };
    </script>

</body>

</html>
